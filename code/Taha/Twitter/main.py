from twitter_driver import TwitterDriver
from neo4j_driver import Neo4jWrapper
from elastic_driver import ElasticDriver
import random
import logging
import time

# nj = Neo4jWrapper()
es = ElasticDriver()
td = TwitterDriver(es)

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(threadName)s - %(name)s - %(levelname)s - %(message)s')


def main():
    # list = ['#bugcrowd', '#bugbounty', 'bug bounty', '#hackerone', '#bugbountytips']
    # random.shuffle(list)
    # for keyword in list:
    #     candidates = get_candidate_tweets(keyword)
    #     candidates.sort(reverse=True, key=lambda tweet: tweet.favorite_count)
    #     for status in candidates:
    #         td.crawl_user(status.user.id)
    # for user in nj.expansion_candidate_by_mention():
    #     td.crawl_user(user)
    for id in [804935972949364736,795470076,1556599177,2207213396,828583568880328704,881166992841080833,805839274092306432,769883225732812800,1376314308,2172415658,785046827301208064,2445275749,4885827185,2552151542,761575326853976064,2904665389,2462064270,2897791291,4744811842,3291805240,789158876176379904,760520792429957120,1067608230,2481701395,799003292135280648,710123736175783938,877191048073809920,163644726,2973645813,878664756545978368,773589699805970432,1014919393900486656,2616126055,1030113891299221509,2778860575,2454009330,458212709,3258726031,873969334850383872,4647683052,760530747484545025,993158683684233216,806121193799557120,1010104218340872192,2835446780,2814024864,26894723,3399774676,42009682,1320338581,4002483725,452450028,440767696,761803948449603584,3252712079,1600646504,1014707310445367296,549069372,967402926837829633,768870602857967616,3246573859,1668330252,2224293582,952380491809763328,3952316474,736615159653924864,1686364364,768786121446813696,41548113,139642469,611037391,3227008113,2575070503,966104090555002880,974269525242736640,450812749,293724954,610710891,2801349150,2665906748,965523606,1020056971582627840,3236566606,963826114702520320,1639251072,1014189106828660738,845673670123147265,825606932887134212,756668856412827648,907805672028254210,1580746687,292852333,874835183727288320,2534889722,895753146,1030246337210605569,802627943235289089,1000805377867382797,922509781046149120,427565158,2186115684,895742794802774017,219895511,983761888122056705,1013358841176604673,784718823622578176,853991948805435393,970567709577662465,861829348197896194,3029244019,966049191226171392,1746206666,241177862,935958460168003584,3605256266,392742895,1667703672,3145845426,592778695,1025692689621118977,992204330391371776,1047380325591072768,799181125578932224,1086365174,1008955939788148736,2187018702,904037554386681856,139252537,507095229,2238935227,909164850718416896,822448179077517315,1114831466,813415378353164288,1004685371907756032,973837166467059712,845411081908604928,955370241663557632,2242329288,231953979,521028694,1314296262,948579347379625989,1025799584,781097362059956224,771037831875661824,978838959609479168,951345607284727808,997416600306356224,3103420267,801336969527754752,1000850609959002112,701353483308498945,967325733742895104,3546088457,1047802036756992002,1033898047678410753,3925442354,360137006,21657641,993893704049004545,751694371175534592,3256876850,4572948792,929702083326103552,1028580601165578240,846288260016062464,1017056475900866560,35809490,379563922,828823948838199296]:
        td.crawl_user(id)
    # td.get_tweets(452450028)
    # td.crawl_user(2481701395)


def get_candidate_tweets(keyword):
    logging.info('getting candidate tweets for ' + keyword)
    search_res = td.search(keyword)
    return search_res


if __name__ == '__main__':
    try:
        main()
        # nj.end()
    except KeyboardInterrupt:
        # nj.end()
        exit(-1)